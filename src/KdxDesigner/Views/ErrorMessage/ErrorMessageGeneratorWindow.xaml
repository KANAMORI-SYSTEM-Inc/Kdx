<Window
    x:Class="KdxDesigner.Views.ErrorMessage.ErrorMessageGeneratorWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ"
    Width="1000"
    Height="700"
    WindowStartupLocation="CenterOwner"
    mc:Ignorable="d">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- è¨­å®šãƒ‘ãƒãƒ« -->
        <GroupBox Grid.Row="0" Header="ç”Ÿæˆè¨­å®š" Margin="0,0,0,10">
            <Grid Margin="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" VerticalAlignment="Center" Text="ã‚¨ãƒ©ãƒ¼é–‹å§‹ç•ªå·:" Margin="0,0,5,0" />
                <TextBox Grid.Column="1" Text="{Binding StartErrorNum, UpdateSourceTrigger=PropertyChanged}" />

                <TextBlock Grid.Column="2" VerticalAlignment="Center" Text="Mãƒ‡ãƒã‚¤ã‚¹é–‹å§‹:" Margin="10,0,5,0" />
                <TextBox Grid.Column="3" Text="{Binding DeviceStartM, UpdateSourceTrigger=PropertyChanged}" />

                <TextBlock Grid.Column="4" VerticalAlignment="Center" Text="Tãƒ‡ãƒã‚¤ã‚¹é–‹å§‹:" Margin="10,0,5,0" />
                <TextBox Grid.Column="5" Text="{Binding DeviceStartT, UpdateSourceTrigger=PropertyChanged}" />

                <TextBlock Grid.Column="6" VerticalAlignment="Center" Text="PLC ID:" Margin="10,0,5,0" />
                <TextBox Grid.Column="7" Text="{Binding PlcId, Mode=OneWay}" IsReadOnly="True" Background="#F0F0F0" />
            </Grid>
        </GroupBox>

        <!-- ç”Ÿæˆå¯¾è±¡é¸æŠž -->
        <GroupBox Grid.Row="1" Header="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆ" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal" Margin="5">
                <Button Content="ðŸ”§ Interlockãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" Command="{Binding GenerateInterlockPreviewCommand}"
                        Width="160" Padding="8" Margin="0,0,10,0"
                        Background="#4CAF50" Foreground="White" FontSize="12" FontWeight="Bold"
                        IsEnabled="{Binding IsInitialized}"
                        ToolTip="Interlockç”¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆã—ã¾ã™" />
                <Button Content="âš™ï¸ Operationãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" Command="{Binding GenerateOperationPreviewCommand}"
                        Width="160" Padding="8" Margin="0,0,20,0"
                        Background="#2196F3" Foreground="White" FontSize="12" FontWeight="Bold"
                        IsEnabled="{Binding IsInitialized}"
                        ToolTip="Operationç”¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆã—ã¾ã™" />
                <TextBlock VerticalAlignment="Center" Margin="0,0,0,0">
                    <Run Text="Interlockå…¥åŠ›æ•°: " />
                    <Run Text="{Binding InterlockInputCount, Mode=OneWay}" FontWeight="Bold" Foreground="#4CAF50" />
                    <Run Text="  Operationå…¥åŠ›æ•°: " />
                    <Run Text="{Binding OperationInputCount, Mode=OneWay}" FontWeight="Bold" Foreground="#2196F3" />
                    <Run Text="  ç”Ÿæˆã‚¨ãƒ©ãƒ¼æ•°: " />
                    <Run Text="{Binding GeneratedErrorCount, Mode=OneWay}" FontWeight="Bold" Foreground="#FF9800" />
                </TextBlock>
                <TextBlock VerticalAlignment="Center" Margin="20,0,0,0" Foreground="Orange" FontWeight="Bold"
                           Visibility="{Binding IsNotInitialized, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Run Text="åˆæœŸåŒ–ä¸­..." />
                </TextBlock>
            </StackPanel>
        </GroupBox>

        <!-- Cycleé¸æŠžãƒ‘ãƒãƒ« (Operationç”¨) -->
        <GroupBox Grid.Row="2" Header="Cycleé¸æŠž (Operationç”¨)" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal" Margin="5">
                <TextBlock VerticalAlignment="Center" Text="Cycle:" Margin="0,0,5,0" />
                <ComboBox
                    ItemsSource="{Binding AvailableCycles}"
                    SelectedItem="{Binding SelectedCycle, Mode=TwoWay}"
                    DisplayMemberPath="CycleName"
                    Width="200"
                    IsEnabled="{Binding IsInitialized}"
                    ToolTip="Operationç”¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã™ã‚‹Cycleã‚’é¸æŠžã—ã¦ãã ã•ã„" />
                <TextBlock VerticalAlignment="Center" Margin="20,0,0,0" Foreground="Gray">
                    <Run Text="é¸æŠžä¸­ã®Cycle ID: " />
                    <Run Text="{Binding CycleId, Mode=OneWay}" FontWeight="Bold" Foreground="#2196F3" />
                </TextBlock>
            </StackPanel>
        </GroupBox>

        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚°ãƒªãƒƒãƒ‰ -->
        <GroupBox Grid.Row="3" Header="ç”Ÿæˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ (GeneratedError)">
            <DataGrid
                ItemsSource="{Binding PreviewErrors}"
                AutoGenerateColumns="False"
                IsReadOnly="True"
                CanUserAddRows="False"
                CanUserDeleteRows="False"
                SelectionMode="Single"
                GridLinesVisibility="All"
                AlternatingRowBackground="#F5F5F5">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ErrorNum" Binding="{Binding ErrorNum}" Width="70" />
                    <DataGridTextColumn Header="DeviceM" Binding="{Binding DeviceM}" Width="70" />
                    <DataGridTextColumn Header="DeviceT" Binding="{Binding DeviceT}" Width="70" />
                    <DataGridTextColumn Header="AlarmId" Binding="{Binding AlarmId}" Width="60" />
                    <DataGridTextColumn Header="Comment1" Binding="{Binding Comment1}" Width="100" />
                    <DataGridTextColumn Header="Comment2" Binding="{Binding Comment2}" Width="120" />
                    <DataGridTextColumn Header="Comment3" Binding="{Binding Comment3}" Width="120" />
                    <DataGridTextColumn Header="Comment4" Binding="{Binding Comment4}" Width="100" />
                    <DataGridTextColumn Header="AlarmComment" Binding="{Binding AlarmComment}" Width="150" />
                    <DataGridTextColumn Header="MessageComment" Binding="{Binding MessageComment}" Width="200" />
                    <DataGridTextColumn Header="ErrorTime" Binding="{Binding ErrorTime}" Width="70" />
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- ãƒœã‚¿ãƒ³ãƒ‘ãƒãƒ« -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <TextBlock VerticalAlignment="Center" Margin="0,0,20,0" Foreground="Gray">
                <Run Text="â€» ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾Œã€ã€Œä¿å­˜ã€ã§Supabaseã«ä¿å­˜ã•ã‚Œã¾ã™" />
            </TextBlock>
            <Button Content="ä¿å­˜" Command="{Binding SaveErrorsCommand}" Width="100" Margin="0,0,10,0"
                    IsEnabled="{Binding CanSave}" />
            <Button Content="é–‰ã˜ã‚‹" Command="{Binding CloseCommand}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}" Width="100" />
        </StackPanel>
    </Grid>
</Window>